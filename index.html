<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Time Capsule</title>
    <!-- Favicon configuration -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="stylesheet" href="styles.css">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' chrome-extension:; style-src 'self' 'unsafe-inline'; connect-src *; img-src 'self' data:;">
</head>
<body>
    <div class="experimental-banner">
        üß™ EXPERIMENTAL PROJECT: This is a testnet demonstration and should not be used for important messages
    </div>

    <header>
        <div class="header-content">
            <h1>Bitcoin Time Capsule</h1>
            <div class="wallet-section">
                <button id="connectWallet">Connect Wallet (Unisat)</button>
                <p id="walletStatus">Wallet Status: Not Connected</p>
            </div>
        </div>
    </header>

    <main>
        <div class="grid-container">
            <!-- Left Column -->
            <div class="left-column">
                <div class="info-card">
                    <h2>üìå What is TimeCapsuleContract?</h2>
                    <p>
                        A blockchain-based message vault that lets users store encrypted messages on Bitcoin Signet.
                        Messages remain locked until a specific future block height is reached.
                        Once unlockable, the first three participants to retrieve messages receive portions of the fees.
                    </p>
                    
                    <div class="alert-box">
                        <h3>üö® Important: Signet BTC Only!</h3>
                        <p>
                            This contract operates on <strong>Bitcoin Signet (testnet)</strong>, not real BTC.
                            You can request free Signet BTC from the <a href="https://signetfaucet.com/" target="_blank">Bitcoin Signet Faucet</a>.
                        </p>
                    </div>
                    
                    <h3>üîπ Enable Signet in Your Wallet</h3>
                    <p>
                        To interact with the contract, switch your wallet to Signet Mode:<br>
                        ‚úÖ Unisat Wallet: Go to settings ‚Üí Select "Network" ‚Üí Enable Signet.
                    </p>
                </div>
                
                <div class="info-card">
                    <h2>üí∞ Fee Distribution</h2>
                    <div class="fee-distribution">
                        <div class="fee-item">
                            <div class="fee-percentage">30%</div>
                            <div class="fee-label">First Unlocker</div>
                        </div>
                        <div class="fee-item">
                            <div class="fee-percentage">20%</div>
                            <div class="fee-label">Second Unlocker</div>
                        </div>
                        <div class="fee-item">
                            <div class="fee-percentage">10%</div>
                            <div class="fee-label">Third Unlocker</div>
                        </div>
                        <div class="fee-item">
                            <div class="fee-percentage">40%</div>
                            <div class="fee-label">Contract Support</div>
                        </div>
                    </div>
                    <p class="fee-note">Storage Fee: 0.0001 Signet BTC per message</p>
                </div>
            </div>
            
            <!-- Right Column -->
            <div class="right-column">
                <!-- Block Height Status -->
                <div class="status-card">
                    <h2>‚è±Ô∏è Time Capsule Status</h2>
                    <div class="block-info">
                        <div class="block-stat">
                            <span class="block-label">Current Block:</span>
                            <span id="currentBlockHeight" class="block-value">Loading...</span>
                        </div>
                        <div class="block-stat">
                            <span class="block-label">Unlock Block:</span>
                            <span id="unlockBlockHeight" class="block-value">263527</span>
                        </div>
                        <div class="block-progress">
                            <div id="progressBar" class="progress-bar"></div>
                        </div>
                    </div>
                    <div id="blockStatus" class="status-indicator pending">
                        <p>Time Capsule messages will be unlockable in approximately <span id="blocksRemaining">...</span> blocks</p>
                        <p>Estimated time remaining: <span id="timeRemaining">...</span></p>
                    </div>
                </div>
                
                <!-- Message Storage Section (hidden until wallet connected) -->
                <div id="messageSection" class="action-card" style="display: none;">
                    <h2>‚úâ Store Your Message</h2>
                    <textarea id="message" placeholder="Write your message here..."></textarea>
                    <div class="char-counter"><span id="charCount">0</span>/150 characters (<span id="byteCount">0</span>/80 bytes)</div>
                    <button onclick="encryptMessage()" class="primary-button">Encrypt & Generate Transaction</button>
                    
                    <div id="encryptionResult" style="display: none;">
                        <h3>üîí Encrypted Message</h3>
                        <p id="encryptedMessageOutput" class="code-block"></p>
                        
                        <h3>üìú Transaction Data</h3>
                        <div id="output" class="transaction-details"></div>
                        
                        <button id="signTransaction" class="primary-button">Sign & Submit</button>
                    </div>
                </div>
                
                <!-- Message Retrieval Section -->
                <div class="action-card">
                    <h2>üîç Retrieve Messages</h2>
                    <div class="tab-container">
                        <button class="tab-button active" onclick="switchTab('storedTab')">Stored Messages</button>
                        <button class="tab-button" onclick="switchTab('retrieveTab')">Lookup by ID</button>
                    </div>
                    
                    <div id="storedTab" class="tab-content active">
                        <div id="storedMessagesList" class="message-list">
                            <p>Loading stored messages...</p>
                        </div>
                    </div>
                    
                    <div id="retrieveTab" class="tab-content">
                        <p>Enter the transaction ID of a message to check its status:</p>
                        <div class="search-container">
                            <input type="text" id="txIdInput" placeholder="Transaction ID...">
                            <button onclick="checkMessage()">Check</button>
                        </div>
                        <div id="messageStatus"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer>
        <p>Bitcoin Time Capsule Contract | <a href="https://github.com/internetmoneylabs/TimeCapsuleContract" target="_blank">GitHub</a></p>
        <p class="disclaimer">This is an experimental project on Bitcoin Signet. No real BTC is used.</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
